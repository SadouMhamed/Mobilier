# HTTPS Mixed Content Fix

## Problem

Your Laravel application deployed on Render was experiencing "Mixed Content" errors because:

-   The site was served over HTTPS (`https://mobilier-pq35.onrender.com/`)
-   But Vite assets (CSS/JS files) were being requested over HTTP
-   Modern browsers block insecure content on HTTPS pages

## Solution Implemented

### 1. Updated AppServiceProvider

Added HTTPS forcing in production environment:

```php
// app/Providers/AppServiceProvider.php
public function boot(): void
{
    // Force HTTPS in production
    if (app()->environment('production')) {
        URL::forceScheme('https');
    }
}
```

### 2. Updated Environment Variables

Added these environment variables to `render.yaml`:

-   `ASSET_URL`: Ensures asset URLs use the correct scheme
-   `SESSION_SECURE_COOKIE`: Forces secure cookies in production

### 3. Enhanced Vite Configuration

Updated `vite.config.js` with better asset organization for production builds.

## Files Modified

1. `app/Providers/AppServiceProvider.php` - Force HTTPS URLs
2. `render.yaml` - Added HTTPS-related environment variables
3. `vite.config.js` - Improved production build configuration

## Next Steps

1. Commit these changes to your repository
2. Push to trigger a new deployment on Render
3. The mixed content errors should be resolved

## Why This Works

-   `URL::forceScheme('https')` ensures all Laravel-generated URLs use HTTPS
-   This includes Vite asset URLs generated by the `@vite` directive
-   The `ASSET_URL` environment variable provides additional assurance
-   `SESSION_SECURE_COOKIE` ensures cookies are only sent over HTTPS

## Testing

After deployment, check your browser's developer tools:

-   No more "Mixed Content" errors in the Console
-   All assets should load over HTTPS
-   The site should function normally without security warnings
